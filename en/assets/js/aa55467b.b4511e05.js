"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6690],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,f=u["".concat(s,".").concat(m)]||u[m]||p[m]||o;return n?a.createElement(f,l(l({ref:t},d),{},{components:n})):a.createElement(f,l({ref:t},d))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5702:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const o={},l="Hot Reload Technology",i={unversionedId:"business/reload/hotreloadassembly",id:"business/reload/hotreloadassembly",title:"Hot Reload Technology",description:"Hot reload technology is used to completely unload or reload an assembly, suitable for small game collections. This solution is only available in the commercial version.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/business/reload/hotreloadassembly.md",sourceDirName:"business/reload",slug:"/business/reload/hotreloadassembly",permalink:"/en/docs/business/reload/hotreloadassembly",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Quick Start",permalink:"/en/docs/business/reload/quickstart"},next:{title:"Free Trial",permalink:"/en/docs/business/reload/freetrial"}},s={},c=[{value:"Supported Features",id:"supported-features",level:2},{value:"Unsupported Features and Special Requirements",id:"unsupported-features-and-special-requirements",level:2},{value:"Incompatible Libraries",id:"incompatible-libraries",level:2},{value:"Resolving References to Unloaded Objects",id:"resolving-references-to-unloaded-objects",level:2}],d={toc:c},u="wrapper";function p(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"hot-reload-technology"},"Hot Reload Technology"),(0,r.kt)("p",null,"Hot reload technology is used to completely unload or reload an assembly, suitable for small game collections. This solution is only available in the ",(0,r.kt)("strong",{parentName:"p"},"commercial version"),"."),(0,r.kt)("h2",{id:"supported-features"},"Supported Features"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Supports unloading assemblies, freeing up 100% of the memory occupied by the assembly."),(0,r.kt)("li",{parentName:"ul"},"Supports reloading assemblies, allowing code to change arbitrarily or even be completely different (with certain limitations on MonoBehaviour and Scriptable)."),(0,r.kt)("li",{parentName:"ul"},"Supports ",(0,r.kt)("strong",{parentName:"li"},"restricting the set of functions that can be accessed in hot-updated assemblies"),", suitable for creating sandbox environments in UGC games to prevent malicious player code from causing damage.")),(0,r.kt)("h2",{id:"unsupported-features-and-special-requirements"},"Unsupported Features and Special Requirements"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Ensure that the business code no longer uses objects or functions from the unloaded Assembly and exits all executing old logic."),(0,r.kt)("li",{parentName:"ul"},"You cannot directly unload a dependent Assembly; you must unload the dependents before the dependencies in reverse dependency order. For example, if A.dll depends on B.dll, you need to unload A.dll first, then B.dll."),(0,r.kt)("li",{parentName:"ul"},"Related to MonoBehaviour and ScriptableObject:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Ensure that overloaded MonoBehaviour event or message functions like Awake and OnEnable are not added or removed (but the function body can change)."),(0,r.kt)("li",{parentName:"ul"},"Ensure that the serialized field names in the script classes with the same name in the old Assembly do not change (the types can change)."),(0,r.kt)("li",{parentName:"ul"},"If the field type is a custom type A (class, struct, or enum) from an unloadable Assembly, it must be marked with the ",(0,r.kt)("inlineCode",{parentName:"li"},"[Serializable]")," attribute."),(0,r.kt)("li",{parentName:"ul"},"Field types such as ",(0,r.kt)("inlineCode",{parentName:"li"},"List&lt;A&gt;"),", where A is a type from an unloadable Assembly, are not supported; replace them with ",(0,r.kt)("inlineCode",{parentName:"li"},"A[]"),"."),(0,r.kt)("li",{parentName:"ul"},"Generic types cannot be inherited, e.g., ",(0,r.kt)("inlineCode",{parentName:"li"},"class MyScript : CommonScript<int>"),"."))),(0,r.kt)("li",{parentName:"ul"},"Some libraries that cache reflection information (most common in serialization-related libraries like LitJson) need to clear cached reflection information after hot reload."),(0,r.kt)("li",{parentName:"ul"},"Destructors ",(0,r.kt)("inlineCode",{parentName:"li"},"~XXX()")," are not supported. Instantiating generic classes with destructors where the generic parameter is a type from the current Assembly is also not allowed."),(0,r.kt)("li",{parentName:"ul"},"Incompatible with DOTS. Due to the extensive caching of type information and the complexity of implementation, it is difficult to individually clear the cached information.")),(0,r.kt)("h2",{id:"incompatible-libraries"},"Incompatible Libraries"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Jobs in 2022 cache type-related information and require minor ",(0,r.kt)("a",{parentName:"li",href:"/en/docs/business/reload/modifydll"},"modifications to UnityEngine.CoreModule.dll")," code. Versions earlier than 2022 do not require modifications."),(0,r.kt)("li",{parentName:"ul"},"Deserialization libraries like LitJson cache reflection information and need to clear the cached reflection information in the library after hot reload. The specific operation depends on the implementation of the library.")),(0,r.kt)("h2",{id:"resolving-references-to-unloaded-objects"},"Resolving References to Unloaded Objects"),(0,r.kt)("p",null,"Hot reload technology requires that metadata of unloaded assembly U cannot be held in the assembly or global memory that has not been unloaded. This includes, but is not limited to:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Instances of types in the unloaded assembly"),(0,r.kt)("li",{parentName:"ul"},"Generic parameters of generic classes or functions that include types from the unloaded assembly"),(0,r.kt)("li",{parentName:"ul"},"Reflection information related to the unloaded assembly, such as Assembly, Type, MethodInfo, PropertyInfo, etc."),(0,r.kt)("li",{parentName:"ul"},"Delegates pointing to functions in the unloaded assembly"),(0,r.kt)("li",{parentName:"ul"},"Tasks defined in the unloaded assembly"),(0,r.kt)("li",{parentName:"ul"},"Others")),(0,r.kt)("p",null,"Real-world projects can be complex, and it is difficult and impractical for developers to find all illegal references. We have implemented illegal reference checks, and when unloading, logs of all illegal references will be printed. Developers can clear all illegal references based on the printed logs."))}p.isMDXComponent=!0}}]);