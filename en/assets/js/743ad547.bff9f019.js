"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2990],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),h=o,m=d["".concat(s,".").concat(h)]||d[h]||p[h]||a;return n?r.createElement(m,i(i({ref:t},c),{},{components:n})):r.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:o,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},21144:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var r=n(87462),o=(n(67294),n(3905));const a={},i="Frequently Asked Questions",l={unversionedId:"business/ultimate/commonerrors",id:"business/ultimate/commonerrors",title:"Frequently Asked Questions",description:"ExecutionEngineException: Could not run the type initializer for origin DHE type 'xxx'",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/business/ultimate/commonerrors.md",sourceDirName:"business/ultimate",slug:"/business/ultimate/commonerrors",permalink:"/en/docs/business/ultimate/commonerrors",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Redirect metadata",permalink:"/en/docs/business/ultimate/retargetmetadata"},next:{title:"\u70ed\u91cd\u8f7d\u7248",permalink:"/en/docs/reload"}},s={},u=[{value:"ExecutionEngineException: Could not run the type initializer for origin DHE type &#39;xxx&#39;",id:"executionengineexception-could-not-run-the-type-initializer-for-origin-dhe-type-xxx",level:2},{value:"Only a small amount of code was changed, but the output log when generating DHA shows that a large number of structs and methods have changed",id:"only-a-small-amount-of-code-was-changed-but-the-output-log-when-generating-dha-shows-that-a-large-number-of-structs-and-methods-have-changed",level:2},{value:"Error: <code>Exception: [SignatureToIdMapper] version mismatch, expected 1, but got 0</code> when generating a dhao or mv file",id:"error-exception-signaturetoidmapper-version-mismatch-expected-1-but-got-0-when-generating-a-dhao-or-mv-file",level:2}],c={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"frequently-asked-questions"},"Frequently Asked Questions"),(0,o.kt)("h2",{id:"executionengineexception-could-not-run-the-type-initializer-for-origin-dhe-type-xxx"},"ExecutionEngineException: Could not run the type initializer for origin DHE type 'xxx'"),(0,o.kt)("p",null,"The reason is that the original AOT type replaced by DHE was accidentally created. After using DHE, you cannot create the original types corresponding to the types in the DHE assembly. There are several reasons for this error:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"DHE code is executed before loading the DHE assembly."),(0,o.kt)("li",{parentName:"ul"},"Hot-reloaded dhe dll does not match the dhao file, resulting in incorrectly executing original AOT code that should not be executed, creating original AOT types. Only versions 4.5.7 and earlier that do not strictly verify the version of the dll will have this error."),(0,o.kt)("li",{parentName:"ul"},"When throwing an exception or printing logs, accessing the original functions of the DHE assembly accidentally during the process of obtaining the function call stack frame. This bug exists in version 4.5.8 and earlier."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"script debugging")," build option is enabled.")),(0,o.kt)("h2",{id:"only-a-small-amount-of-code-was-changed-but-the-output-log-when-generating-dha-shows-that-a-large-number-of-structs-and-methods-have-changed"},"Only a small amount of code was changed, but the output log when generating DHA shows that a large number of structs and methods have changed"),(0,o.kt)("p",null,"A small amount of code changes will generally only affect the function in which it is located. If a large number of functions change, it means that the original DHE DLL or the latest DHE DLL used when generating DHA is very different. There are several possible reasons:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The wrong original DHE DLL or the latest DHE DLL was used"),(0,o.kt)("li",{parentName:"ul"},"Inconsistent development options lead to huge differences in DLLs. For example, the development option is turned on when building the main package, but the ",(0,o.kt)("inlineCode",{parentName:"li"},"CompileDll/activeTarget_development")," command is not used when compiling the DLL. Or the development option is disabled when constructing the main package, but the ",(0,o.kt)("inlineCode",{parentName:"li"},"CompileDll/activeTarget_development")," is used when compiling the DLL."),(0,o.kt)("li",{parentName:"ul"},"The DHE assembly is a precompiled DLL. When constructing the main package, the DHE assembly is trimmed, resulting in a huge difference with the latest DHE DLL. The solution is to add ",(0,o.kt)("inlineCode",{parentName:"li"},'<assembly fullname="YourExternDll" preserve="all"/>')," in ",(0,o.kt)("inlineCode",{parentName:"li"},"link.xml")," to completely retain the DLL")),(0,o.kt)("h2",{id:"error-exception-signaturetoidmapper-version-mismatch-expected-1-but-got-0-when-generating-a-dhao-or-mv-file"},"Error: ",(0,o.kt)("inlineCode",{parentName:"h2"},"Exception: [SignatureToIdMapper] version mismatch, expected 1, but got 0")," when generating a dhao or mv file"),(0,o.kt)("p",null,"A bug in function signature calculation has been fixed since version 8.4.0. This fix results in a change in the way function signatures are calculated. This error will occur if you use a snapshot generated with an older version of HybridCLR with the latest hot-update code to generate a dhao or mv file."),(0,o.kt)("p",null,"Solution:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you have already released your game app and are using the meta version workflow,")),(0,o.kt)("p",null,"enable the ",(0,o.kt)("inlineCode",{parentName:"p"},"HybridCLRSettings.generateCompatibleMethodSignature")," option. However, due to a bug in method signature calculation in this version, it is recommended that you upgrade to v8.4.0 or later when re-releasing your app."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you have already released your game app but are using the dhao workflow,")),(0,o.kt)("p",null,"you should not encounter this error."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you are still in development,")),(0,o.kt)("p",null,"Re-release your app and regenerate the aot snapshot."))}p.isMDXComponent=!0}}]);