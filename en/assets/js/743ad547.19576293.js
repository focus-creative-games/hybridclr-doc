"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2990],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),h=o,m=d["".concat(s,".").concat(h)]||d[h]||p[h]||a;return n?r.createElement(m,i(i({ref:t},c),{},{components:n})):r.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:o,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},21144:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var r=n(87462),o=(n(67294),n(3905));const a={},i="Common Issues",l={unversionedId:"business/ultimate/commonerrors",id:"business/ultimate/commonerrors",title:"Common Issues",description:"ExecutionEngineException: Could not run the type initializer for origin DHE type 'xxx'",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/business/ultimate/commonerrors.md",sourceDirName:"business/ultimate",slug:"/business/ultimate/commonerrors",permalink:"/en/docs/business/ultimate/commonerrors",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Retarget Metadata",permalink:"/en/docs/business/ultimate/retargetmetadata"},next:{title:"\u70ed\u91cd\u8f7d\u7248",permalink:"/en/docs/reload"}},s={},u=[{value:"ExecutionEngineException: Could not run the type initializer for origin DHE type &#39;xxx&#39;",id:"executionengineexception-could-not-run-the-type-initializer-for-origin-dhe-type-xxx",level:2},{value:"Only changed a small amount of code, but when generating meta version, the output log or <code>.diff.spec</code> shows a huge amount of struct and method changes",id:"only-changed-a-small-amount-of-code-but-when-generating-meta-version-the-output-log-or-diffspec-shows-a-huge-amount-of-struct-and-method-changes",level:2},{value:"Encountered error <code>Exception: [SignatureToIdMapper] version mismatch, expected 1, but got 0</code> when generating dhao or mv files",id:"encountered-error-exception-signaturetoidmapper-version-mismatch-expected-1-but-got-0-when-generating-dhao-or-mv-files",level:2}],c={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"common-issues"},"Common Issues"),(0,o.kt)("h2",{id:"executionengineexception-could-not-run-the-type-initializer-for-origin-dhe-type-xxx"},"ExecutionEngineException: Could not run the type initializer for origin DHE type 'xxx'"),(0,o.kt)("p",null,"The reason is that the original AOT type replaced by DHE was unexpectedly created. After using DHE, you cannot create the original type corresponding to the type in the DHE assembly. There are several reasons that cause this error:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Executed code in the DHE assembly before loading the DHE assembly"),(0,o.kt)("li",{parentName:"ul"},"The hot update dhe dll and dhao file do not match, causing the original AOT code that should not be executed to be executed incorrectly, creating the original AOT type. Only versions 4.5.7 and earlier that did not strictly validate dlls would have this error"),(0,o.kt)("li",{parentName:"ul"},"When throwing exceptions or printing logs, the original function of the DHE assembly was unexpectedly accessed during the process of obtaining function frame stacks. Versions 4.5.8 and earlier have this bug"),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"script debugging")," build parameter is enabled")),(0,o.kt)("h2",{id:"only-changed-a-small-amount-of-code-but-when-generating-meta-version-the-output-log-or-diffspec-shows-a-huge-amount-of-struct-and-method-changes"},"Only changed a small amount of code, but when generating meta version, the output log or ",(0,o.kt)("inlineCode",{parentName:"h2"},".diff.spec")," shows a huge amount of struct and method changes"),(0,o.kt)("p",null,"Small code changes generally only affect the function they are in. If a huge amount of function changes occur, it means there is a big difference between the original dhe dll used when generating dhao or the latest dhe dll. There may be several reasons:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Used the wrong original dhe dll or the latest dhe dll"),(0,o.kt)("li",{parentName:"ul"},"Inconsistent development options causing huge dll differences. For example, the development option was enabled when building the main package, but the ",(0,o.kt)("inlineCode",{parentName:"li"},"CompileDll/activeTarget_development")," command was not used when compiling the dll. Or the development option was disabled when building the main package, but ",(0,o.kt)("inlineCode",{parentName:"li"},"CompileDll/activeTarget_development")," was used when compiling the dll, both will cause this problem."),(0,o.kt)("li",{parentName:"ul"},"The dhe assembly is a pre-compiled dll, and the dhe assembly was stripped when building the main package, causing huge differences with the latest dhe dll. The solution is to add ",(0,o.kt)("inlineCode",{parentName:"li"},'<assembly fullname="YourExternDll" preserve="all"/>')," in ",(0,o.kt)("inlineCode",{parentName:"li"},"link.xml")," to completely preserve the dll")),(0,o.kt)("h2",{id:"encountered-error-exception-signaturetoidmapper-version-mismatch-expected-1-but-got-0-when-generating-dhao-or-mv-files"},"Encountered error ",(0,o.kt)("inlineCode",{parentName:"h2"},"Exception: [SignatureToIdMapper] version mismatch, expected 1, but got 0")," when generating dhao or mv files"),(0,o.kt)("p",null,"Starting from version v8.4.0, a function signature calculation bug was fixed, and the function signature calculation method changed after the fix. If you use a snapshot generated by an old version of hybridclr with the latest hot update code to generate dhao or mv files, this error will occur."),(0,o.kt)("p",null,"Solution:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you have already released the game App to the public and are using the meta version workflow")),(0,o.kt)("p",null,"Enable the ",(0,o.kt)("inlineCode",{parentName:"p"},"HybridCLRSettings.generateCompatibleMethodSignature")," option. However, since this version has a bug in method signature calculation, it is recommended to upgrade to v8.4.0 and higher when republishing the app."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If you have already released the game App to the public but are using the dhao workflow")),(0,o.kt)("p",null,"You should not encounter this error."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If still in development")),(0,o.kt)("p",null,"Republish the App and regenerate the aot snapshot."))}p.isMDXComponent=!0}}]);