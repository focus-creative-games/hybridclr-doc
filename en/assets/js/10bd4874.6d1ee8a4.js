"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3336],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(n),p=r,h=u["".concat(s,".").concat(p)]||u[p]||f[p]||a;return n?i.createElement(h,o(o({ref:t},d),{},{components:n})):i.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<a;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},29631:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>f,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var i=n(87462),r=(n(67294),n(3905));const a={},o="Differential Hybrid Execution (DHE)",l={unversionedId:"business/differentialhybridexecution",id:"version-7.8.1/business/differentialhybridexecution",title:"Differential Hybrid Execution (DHE)",description:"HybridCLR introduces the groundbreaking Differential Hybrid Execution (DHE) technology. It allows for arbitrary modifications to AOT DLLs, intelligently running changed or newly added classes and functions in interpreter mode while unchanged classes and functions run in AOT mode, enabling the performance of hot-updated game logic to reach nearly the level of native AOT.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-7.8.1/business/differentialhybridexecution.md",sourceDirName:"business",slug:"/business/differentialhybridexecution",permalink:"/en/docs/7.8.1/business/differentialhybridexecution",draft:!1,tags:[],version:"7.8.1",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/en/docs/7.8.1/business/intro"},next:{title:"Full Generic Sharing",permalink:"/en/docs/7.8.1/business/fullgenericsharing"}},s={},c=[{value:"Principle",id:"principle",level:2},{value:"Features and Advantages",id:"features-and-advantages",level:2},{value:"Unsupported Features",id:"unsupported-features",level:2},{value:"dhao Files",id:"dhao-files",level:2}],d={toc:c},u="wrapper";function f(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"differential-hybrid-execution-dhe"},"Differential Hybrid Execution (DHE)"),(0,r.kt)("p",null,"HybridCLR introduces the groundbreaking Differential Hybrid Execution (DHE) technology. It allows for arbitrary modifications to AOT DLLs, intelligently running changed or newly added classes and functions in interpreter mode while unchanged classes and functions run in AOT mode, enabling the performance of hot-updated game logic to reach nearly the level of native AOT."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"DHE is only available in the ",(0,r.kt)("strong",{parentName:"p"},"Ultimate Edition"),". Please refer to the ",(0,r.kt)("a",{parentName:"p",href:"../business/ultimate/intro"},"Ultimate Edition introduction")," for details.")),(0,r.kt)("h2",{id:"principle"},"Principle"),(0,r.kt)("p",null,"The assemblies marked as DHE are also packaged into the main bundle. After running, the latest hotfix DLL is loaded. During execution, when calling a function from a DHE assembly, if the function has not changed, the native AOT implementation is directly invoked; otherwise, the latest code is executed in interpreter mode. Since in practice, the two versions often do not modify too much code, DHE can basically achieve performance close to native levels."),(0,r.kt)("h2",{id:"features-and-advantages"},"Features and Advantages"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Unchanged code performs exactly like native AOT, with performance gains ranging from ",(0,r.kt)("strong",{parentName:"li"},"3-30")," times or higher compared to pure interpretation versions, nearly reaching native performance levels."),(0,r.kt)("li",{parentName:"ul"},"Arbitrary changes can be made to the code, with almost no intrusions to the codebase and minimal special considerations, similar to the community version."),(0,r.kt)("li",{parentName:"ul"},"Simple workflow, no need to manually mark which functions have changed like other solutions such as xxxfix; everything is handled automatically by the tool."),(0,r.kt)("li",{parentName:"ul"},"Lower project transformation costs compared to pure hotfix versions. For example, extern functions can be directly defined in DHE without the need to move to the AOT module."),(0,r.kt)("li",{parentName:"ul"},"All native code is included in the package, significantly reducing the risk of iOS rejection.")),(0,r.kt)("h2",{id:"unsupported-features"},"Unsupported Features"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"No code from the corresponding AOT assembly can be executed before loading DHE hotfix code. This means that DHE does not support differential mixing like mscorlib, but supports traditional hotfix assembly differential updates."),(0,r.kt)("li",{parentName:"ul"},"Due to the first limitation, features such as ",(0,r.kt)("inlineCode",{parentName:"li"},"[InitializeOnLoadMethod]")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Script Execution Order settings")," are not supported in DHE assemblies."),(0,r.kt)("li",{parentName:"ul"},"DHE scripts cannot be mounted on resources included in the package, including Resources."),(0,r.kt)("li",{parentName:"ul"},"Extern functions cannot be added through hotfix updates in DHE assemblies.")),(0,r.kt)("h2",{id:"dhao-files"},"dhao Files"),(0,r.kt)("p",null,"The dhao file is a core concept of the DHE technology. It contains pre-calculated information about the types and functions that have changed in the latest hotfix DLL, allowing the runtime to determine whether to use the latest interpreted version or directly call the original AOT function when executing a hotfix function. Pre-calculated dhao files are crucial for DHE technology to function properly. Without a dhao file, the original AOT DLL must be carried along, and the cost of calculating function changes is extremely high."),(0,r.kt)("p",null,"By comparing the latest hotfix DLL with the AOT DLL generated during packaging, the changed types and functions are calculated offline and saved as dhao files. Therefore, for the DHE mechanism to work properly, it depends on the correctness of the dhao file, which in turn depends on accurately providing the latest hotfix DLL and the AOT DLL generated during packaging."))}f.isMDXComponent=!0}}]);