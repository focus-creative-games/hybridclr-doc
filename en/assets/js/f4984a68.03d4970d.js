"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5956],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),m=a,h=u["".concat(c,".").concat(m)]||u[m]||d[m]||o;return n?r.createElement(h,i(i({ref:t},l),{},{components:n})):r.createElement(h,i({ref:t},l))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},27707:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const o={},i="Using MonoBehaviour",s={unversionedId:"beginner/monobehaviour",id:"version-8.5.0/beginner/monobehaviour",title:"Using MonoBehaviour",description:"HybridCLR fully supports the MonoBehaviour workflow. You can dynamically attach hot update scripts through AddComponent in code, or attach hot update scripts to assets and restore them by loading assets.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-8.5.0/beginner/monobehaviour.md",sourceDirName:"beginner",slug:"/beginner/monobehaviour",permalink:"/en/docs/8.5.0/beginner/monobehaviour",draft:!1,tags:[],version:"8.5.0",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Quick Start Guide",permalink:"/en/docs/8.5.0/beginner/quickstart"},next:{title:"Using Generics",permalink:"/en/docs/8.5.0/beginner/generic"}},c={},p=[{value:"Create <code>Print.cs</code> Hot Update Script",id:"create-printcs-hot-update-script",level:2},{value:"Dynamically Attach Hot Update Scripts Using AddComponent in Code",id:"dynamically-attach-hot-update-scripts-using-addcomponent-in-code",level:2},{value:"Resolve GameObject Stripping Issues",id:"resolve-gameobject-stripping-issues",level:2},{value:"Attach Scripts to Hot Update Assets",id:"attach-scripts-to-hot-update-assets",level:2}],l={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"using-monobehaviour"},"Using MonoBehaviour"),(0,a.kt)("p",null,"HybridCLR fully supports the MonoBehaviour workflow. You can dynamically attach hot update scripts through AddComponent in code, or attach hot update scripts to assets and restore them by loading assets."),(0,a.kt)("p",null,"Based on the quick start guide project, we demonstrate how to use hot update scripts."),(0,a.kt)("h2",{id:"create-printcs-hot-update-script"},"Create ",(0,a.kt)("inlineCode",{parentName:"h2"},"Print.cs")," Hot Update Script"),(0,a.kt)("p",null,"Create the ",(0,a.kt)("inlineCode",{parentName:"p"},"Assets/HotUpdate/Print.cs")," script with the following code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class Print : MonoBehaviour\n{\n    void Start()\n    {\n        Debug.Log($"[Print] GameObject:{name}");   \n    }\n}\n')),(0,a.kt)("h2",{id:"dynamically-attach-hot-update-scripts-using-addcomponent-in-code"},"Dynamically Attach Hot Update Scripts Using AddComponent in Code"),(0,a.kt)("p",null,"Modify the ",(0,a.kt)("inlineCode",{parentName:"p"},"Hello.Run")," function to add code for dynamically attaching the Print script. The final code is as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-csharp"},'    public static void Run()\n    {\n        Debug.Log("Hello, World");\n\n        GameObject go = new GameObject("Test1");\n        go.AddComponent<Print>();\n    }\n')),(0,a.kt)("h2",{id:"resolve-gameobject-stripping-issues"},"Resolve GameObject Stripping Issues"),(0,a.kt)("p",null,"Since GameObject is not used at all in the quick start guide, some functions of the GameObject type are stripped during packaging. You need to perform the following operations, otherwise you'll encounter a ",(0,a.kt)("inlineCode",{parentName:"p"},"GameObject::.ctor")," function not found error when running the hot update code:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Run the ",(0,a.kt)("inlineCode",{parentName:"li"},"HybridCLR/Generate/All")," command to re-scan hot update assemblies and generate link.xml to preserve types used in hot update code."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Rebuild the package"),".")),(0,a.kt)("p",null,"After hot updating, a new log line ",(0,a.kt)("inlineCode",{parentName:"p"},"[Print] GameObject:Test1")," will appear on the screen."),(0,a.kt)("h2",{id:"attach-scripts-to-hot-update-assets"},"Attach Scripts to Hot Update Assets"),(0,a.kt)("p",null,"Due to Unity's resource management system limitations, assets (prefab, scene, ScriptableObject resources) with hot update scripts attached ",(0,a.kt)("strong",{parentName:"p"},"must be built into assetbundles")," and instantiated from ab packages to properly restore scripts."),(0,a.kt)("admonition",{type:"danger"},(0,a.kt)("p",{parentName:"admonition"},(0,a.kt)("strong",{parentName:"p"},"If hot update scripts are attached to resources that come with the main package like Resources, scripting missing errors will occur!")," However, if they are first built into assetbundle packages and then placed in Resources, loading that bundled assetbundle at runtime is fine.")),(0,a.kt)("p",null,"Since the entire process involves building ab packages and is quite lengthy, it won't be detailed here. Please directly experience the hybridclr_trial project (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/focus-creative-games/hybridclr_trial"},"github")," or ",(0,a.kt)("a",{parentName:"p",href:"https://gitee.com/focus-creative-games/hybridclr_trial"},"gitee"),")."),(0,a.kt)("p",null,"For beginners, you just need to remember: resources (scenes or prefabs) with hot update scripts attached must be packaged into ab, and load the hot update dll before instantiating resources (this requirement is obvious!)."))}d.isMDXComponent=!0}}]);