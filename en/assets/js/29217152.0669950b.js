"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5306],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),d=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=d(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=d(n),m=a,f=p["".concat(s,".").concat(m)]||p[m]||u[m]||i;return n?r.createElement(f,l(l({ref:t},c),{},{components:n})):r.createElement(f,l({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:a,l[1]=o;for(var d=2;d<i;d++)l[d]=n[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9066:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var r=n(7462),a=(n(7294),n(3905));const i={},l="Migrate projects whose Api Level is netstandard",o={unversionedId:"basic/migratefromnetstandard",id:"basic/migratefromnetstandard",title:"Migrate projects whose Api Level is netstandard",description:"During the building pipeline, Unity will convert all references to netstandard.dll into final references such as mscorlib.dll, resulting in original code",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/basic/migratefromnetstandard.md",sourceDirName:"basic",slug:"/basic/migratefromnetstandard",permalink:"/en/docs/basic/migratefromnetstandard",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Best Practices",permalink:"/en/docs/basic/bestpractice"},next:{title:"HybridCLR+lua/js/python",permalink:"/en/docs/basic/workwithscriptlanguage"}},s={},d=[{value:"Migration steps",id:"migration-steps",level:2},{value:"Convert external dll based on netstarndard",id:"convert-external-dll-based-on-netstarndard",level:2}],c={toc:d},p="wrapper";function u(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"migrate-projects-whose-api-level-is-netstandard"},"Migrate projects whose Api Level is netstandard"),(0,a.kt)("p",null,"During the building pipeline, Unity will convert all references to netstandard.dll into final references such as mscorlib.dll, resulting in original code\nThe reference relationship is very different from the final reference relationship. This difference will cause the command under ",(0,a.kt)("inlineCode",{parentName:"p"},"Generate/All/*")," to run incorrectly. At the same time due to\nThe hot update dll compiled by the ",(0,a.kt)("inlineCode",{parentName:"p"},"HybridCLR/CompileDll/*")," command still references ",(0,a.kt)("inlineCode",{parentName:"p"},"netstandard")," instead of the final mscorlib and other programs.\nset, causing an error that the type in netstandard cannot be found when loading and running the hot update dll. Therefore, HybridCLR requires the use of ",(0,a.kt)("inlineCode",{parentName:"p"},"Net Framework")," by default\nAPI Level."),(0,a.kt)("p",null,"Some projects originally worked on the .net standard Api Level. In order to be able to work normally after being connected to HybridCLR, some migration work needs to be performed.\nFortunately, these tasks are one-time only."),(0,a.kt)("h2",{id:"migration-steps"},"Migration steps"),(0,a.kt)("p",null,"Migration mainly consists of two steps:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Convert the precompiled netstandard-based dll in the project to the .net framework-based dll"),(0,a.kt)("li",{parentName:"ul"},"Switch the project's Api Level to .Net Framework")),(0,a.kt)("h2",{id:"convert-external-dll-based-on-netstarndard"},"Convert external dll based on netstarndard"),(0,a.kt)("p",null,"If you can directly find the .Net Framework-based version of the external dll, just replace the dll corresponding to the project. If not found,\nThen you can use Unity's building pipeline to generate the final aot dll based on .Net Framework, and generate the dll's\n.Net Framework version. The specific operation is as follows:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Make sure that the main project already has code that references this external dll, not just the dll that is referenced in the hot update code"),(0,a.kt)("li",{parentName:"ul"},"Preserve this dll in any link.xml, such as adding ",(0,a.kt)("inlineCode",{parentName:"li"},'<assembly fullname="xxx.dll" preserve="all"/>')," in ",(0,a.kt)("inlineCode",{parentName:"li"},"Assets/link.xml")),(0,a.kt)("li",{parentName:"ul"},"Run ",(0,a.kt)("inlineCode",{parentName:"li"},"HybridCLR/Generate/AOTDlls")),(0,a.kt)("li",{parentName:"ul"},"Obtain the file corresponding to the dll in the clipping directory of ",(0,a.kt)("inlineCode",{parentName:"li"},"{project}/HybridCLRData/AssembliesPostIl2CppStrip/{target}")),(0,a.kt)("li",{parentName:"ul"},"Use this dll to replace the corresponding dll in the project")))}u.isMDXComponent=!0}}]);