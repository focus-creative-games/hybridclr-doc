"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2757],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var i=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},f=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=c(n),f=r,h=u["".concat(s,".").concat(f)]||u[f]||p[f]||a;return n?i.createElement(h,o(o({ref:t},d),{},{components:n})):i.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,o=new Array(a);o[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var c=2;c<a;c++)o[c]=n[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}f.displayName="MDXCreateElement"},38138:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var i=n(87462),r=(n(67294),n(3905));const a={},o="Differential Hybrid Execution",l={unversionedId:"business/differentialhybridexecution",id:"business/differentialhybridexecution",title:"Differential Hybrid Execution",description:"HybridCLR pioneered the implementation of Differential Hybrid Execution (DHE) technology. It allows arbitrary additions, deletions, and modifications to AOT DLLs, intelligently running changed or new classes and functions in interpreter mode while unchanged classes and functions run in AOT mode, making hot-updated game logic performance essentially reach native AOT levels.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/business/differentialhybridexecution.md",sourceDirName:"business",slug:"/business/differentialhybridexecution",permalink:"/en/docs/business/differentialhybridexecution",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/en/docs/business/intro"},next:{title:"Full Generic Sharing",permalink:"/en/docs/business/fullgenericsharing"}},s={},c=[{value:"Principle",id:"principle",level:2},{value:"Features and Advantages",id:"features-and-advantages",level:2},{value:"Unsupported Features",id:"unsupported-features",level:2},{value:"dhao Files",id:"dhao-files",level:2}],d={toc:c},u="wrapper";function p(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"differential-hybrid-execution"},"Differential Hybrid Execution"),(0,r.kt)("p",null,"HybridCLR pioneered the implementation of Differential Hybrid Execution (DHE) technology. It allows arbitrary additions, deletions, and modifications to AOT DLLs, intelligently running changed or new classes and functions in interpreter mode while unchanged classes and functions run in AOT mode, making hot-updated game logic performance essentially reach native AOT levels."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"DHE is only included in the ",(0,r.kt)("strong",{parentName:"p"},"Ultimate Edition"),". For details, please see ",(0,r.kt)("a",{parentName:"p",href:"../business/ultimate/intro"},"Ultimate Edition Introduction"),".")),(0,r.kt)("h2",{id:"principle"},"Principle"),(0,r.kt)("p",null,"Assemblies marked as DHE are also packaged into the main build, then the latest hot update DLL is loaded at runtime. During execution, when calling a function from a DHE assembly, if the function hasn't changed, it directly calls the native AOT implementation; otherwise, it executes the latest code interpretively.\nSince in practice, two versions often don't modify too much code, DHE can achieve performance levels close to native."),(0,r.kt)("h2",{id:"features-and-advantages"},"Features and Advantages"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Unchanged code parts have identical performance to native, providing an amazing ",(0,r.kt)("strong",{parentName:"li"},"3-30x")," or higher improvement compared to pure interpretation versions, with overall performance nearly reaching native levels."),(0,r.kt)("li",{parentName:"ul"},"Allows arbitrary code changes with minimal code intrusion and almost no special considerations. Usage is similar to the community version."),(0,r.kt)("li",{parentName:"ul"},"Simple workflow that doesn't require manually marking which functions have changed like xxxfix solutions - tools handle everything automatically."),(0,r.kt)("li",{parentName:"ul"},"Lower transformation cost for projects compared to pure hot update versions. For example, extern functions can be defined directly in DHE without moving to AOT modules."),(0,r.kt)("li",{parentName:"ul"},"Native code is fully included in the package, significantly reducing the risk of iOS App Store rejection.")),(0,r.kt)("h2",{id:"unsupported-features"},"Unsupported Features"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"No code from the DHE-corresponding AOT assembly can be executed before loading DHE hot update code. This means DHE doesn't support differential hybrid for basic libraries like mscorlib, but supports differential hot updates for traditional hot update assemblies."),(0,r.kt)("li",{parentName:"ul"},"Due to the first limitation, ",(0,r.kt)("inlineCode",{parentName:"li"},"[InitializeOnLoadMethod]")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"Script Execution Order settings")," are not supported in DHE assemblies."),(0,r.kt)("li",{parentName:"ul"},"DHE scripts cannot be attached to bundled assets, including Resources."),(0,r.kt)("li",{parentName:"ul"},"Cannot add new extern functions through hot updates in DHE assemblies.")),(0,r.kt)("h2",{id:"dhao-files"},"dhao Files"),(0,r.kt)("p",null,"The dhao file is the core concept of DHE technology. It contains offline-calculated information about changed types and functions in the latest hot update DLL. At runtime, the system directly uses information from the dhao file to decide whether to use the latest interpreted version or directly call the original AOT function when executing a hot update function.\nOffline-calculated dhao files are crucial for DHE technology. Without dhao files, the original AOT DLL would need to be carried additionally, and the cost of calculating function changes would be extremely high."),(0,r.kt)("p",null,"By comparing the latest hot update DLL with the AOT DLL generated during packaging, changed types and functions are calculated offline and saved as dhao files. Therefore, for the DHE mechanism to work correctly, it must rely on the correctness of the dhao file, which in turn depends on accurately providing the latest hot update DLL and the AOT DLL generated during packaging."))}p.isMDXComponent=!0}}]);