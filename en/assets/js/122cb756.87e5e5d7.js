"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7501],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>f});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),d=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},c=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=d(r),u=a,f=p["".concat(s,".").concat(u)]||p[u]||m[u]||i;return r?n.createElement(f,l(l({ref:t},c),{},{components:r})):n.createElement(f,l({ref:t},c))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,l=new Array(i);l[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:a,l[1]=o;for(var d=2;d<i;d++)l[d]=r[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},70194:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var n=r(87462),a=(r(67294),r(3905));const i={},l="Migrating from netstandard to .Net Framework",o={unversionedId:"basic/migratefromnetstandard",id:"version-8.5.0/basic/migratefromnetstandard",title:"Migrating from netstandard to .Net Framework",description:"During Unity's packaging process, all references to netstandard.dll are converted to final references like mscorlib.dll, causing the original code's reference relationships to differ significantly from the final reference relationships. This difference causes the Generate/All/ commands to run with errors. Additionally, since the hot update dlls compiled by HybridCLR/CompileDll/ commands still reference netstandard rather than the final assemblies like mscorlib, loading and running hot update dlls will result in errors where types in netstandard cannot be found. Therefore, HybridCLR defaults to requiring the use of Net Framework Api Level.",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-8.5.0/basic/migratefromnetstandard.md",sourceDirName:"basic",slug:"/basic/migratefromnetstandard",permalink:"/en/docs/8.5.0/basic/migratefromnetstandard",draft:!1,tags:[],version:"8.5.0",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Best Practices",permalink:"/en/docs/8.5.0/basic/bestpractice"},next:{title:"HybridCLR + lua/js/python",permalink:"/en/docs/8.5.0/basic/workwithscriptlanguage"}},s={},d=[{value:"Migration Steps",id:"migration-steps",level:2},{value:"Converting External netstandard-based DLLs",id:"converting-external-netstandard-based-dlls",level:2}],c={toc:d},p="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(p,(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"migrating-from-netstandard-to-net-framework"},"Migrating from netstandard to .Net Framework"),(0,a.kt)("p",null,"During Unity's packaging process, all references to netstandard.dll are converted to final references like mscorlib.dll, causing the original code's reference relationships to differ significantly from the final reference relationships. This difference causes the ",(0,a.kt)("inlineCode",{parentName:"p"},"Generate/All/*")," commands to run with errors. Additionally, since the hot update dlls compiled by ",(0,a.kt)("inlineCode",{parentName:"p"},"HybridCLR/CompileDll/*")," commands still reference ",(0,a.kt)("inlineCode",{parentName:"p"},"netstandard")," rather than the final assemblies like mscorlib, loading and running hot update dlls will result in errors where types in netstandard cannot be found. Therefore, HybridCLR defaults to requiring the use of ",(0,a.kt)("inlineCode",{parentName:"p"},"Net Framework")," Api Level."),(0,a.kt)("p",null,"Some projects originally worked on .net standard Api Level. To work properly after integrating HybridCLR, some migration work needs to be performed.\nFortunately, this work is one-time only."),(0,a.kt)("h2",{id:"migration-steps"},"Migration Steps"),(0,a.kt)("p",null,"Migration mainly includes two steps:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Convert pre-compiled netstandard-based dlls in the project to .net framework-based dlls"),(0,a.kt)("li",{parentName:"ul"},"Switch the project's Api Level to .Net Framework")),(0,a.kt)("h2",{id:"converting-external-netstandard-based-dlls"},"Converting External netstandard-based DLLs"),(0,a.kt)("p",null,"If you can directly find a .Net Framework-based version of the external dll, simply replace the corresponding dll in the project. If you can't find one,\nyou can utilize Unity's packaging process feature that generates final .Net Framework-based aot dlls to generate\nthe .Net Framework version of that dll. Specific operations are as follows:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Ensure the main project has code that references this external dll, not just hot update code referencing the dll"),(0,a.kt)("li",{parentName:"ul"},"Preserve this dll in any link.xml, such as adding ",(0,a.kt)("inlineCode",{parentName:"li"},'<assembly fullname="xxx.dll" preserve="all"/>')," in ",(0,a.kt)("inlineCode",{parentName:"li"},"Assets/link.xml")),(0,a.kt)("li",{parentName:"ul"},"Run ",(0,a.kt)("inlineCode",{parentName:"li"},"HybridCLR/Generate/AOTDlls")),(0,a.kt)("li",{parentName:"ul"},"Obtain the corresponding file for that dll in the stripped directory ",(0,a.kt)("inlineCode",{parentName:"li"},"{project}/HybridCLRData/AssembliesPostIl2CppStrip/{target}")),(0,a.kt)("li",{parentName:"ul"},"Replace the corresponding dll in the project with this dll")))}m.isMDXComponent=!0}}]);